# TransactionTest 

Сервис для управления кошельками и переводами. Реализованы функции создания, удаления и обновления кошельков, перевода средств, а также получения балансов и истории транзакций.

Используется PostgreSQL (pgxpool). Архитектура приближена к чистой: разделены слои обработки HTTP-запросов, бизнес-логики, работы с репозиторием и хранилищем.

Конфигурация хранится в config/. Путь можно переопределить через переменную окружения CONFIG_FILE_PATH. Если переменная не задана, то используется - CONFIG_FILE_PATH

Логирование реализовано через zap, все запросы логируются. В каждом запросе нужно высылать так же RequestID, но я в main задал его заранне, поэтому если потребуется возможность задвать RequestID в запросе, то следует отдать сервису и хэдлеру новый "чистый" logger.Logger. Еще есть middleware, который в закладывает в контекст ReqestID, строка  с ним закомментирована.

К трем основным эндпоинтам я реалиовал еще несколько вспомогательных (CRUD). Документация к эндпоинтам лежит в ./internal/delivery/http/handler. 

Миграции работают через golange migrate. Работал с ними впервые, поэтому не уверен в полученном результате. Из за того, что migrate, как я понял, не поддреживает форматирование (параметризирование), я восползовался своим "драйвером", который его встраивает. Используется формат - {{.ParamName}} (text/template), если задавать свои параметры, то стоит заглянуть в migration.Open().

 Немного о реализации и моём подходе - я старался спроектировать все так, чтобы слоем могли пользоваться не только предусмотренные мной. Этим я обосновываю несколько одинаковых проверок в нексольких слоях. К примеру при добавлении gRPC, на начальном этапе в нём может отсутствовать полноценная валидация входных данных.

Теперь касательно задачи - создавать 10 кошельков при первом запуске. Я рещил эту задачу так - d конфигурации предусмотрен отдельный раздел seeding, где можно задать маркер файл, который будет сигнализировать о том, что первый запуск уже был. В этот файл записывается 10 адресов, в случае если FailOnError установлен в false, то их может быть и меньше. При этом, если файл удалить, то процесс создания указанного в конфигурации количества вновь повториться (если сидинг останеться включенным).

Касательно запуска - либо через go run cmd/server/main.go (либо build), либо через docker-compose up.

Тестами были покрыты: service и repository
Запустить тесты - go test ./...

Весь код отформатирован через go fmt. 
Работал в SiblimeText